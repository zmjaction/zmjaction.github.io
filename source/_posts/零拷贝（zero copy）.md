---
title: 零拷贝
mathjax: false
date: 2020-05-22 23:17:58
categories:
    - Middleware
    - MQ
    - Kafka
tags:
    - Middleware
    - MQ
    - Kafka
    - 零拷贝
---

### 文件传输到网络的公共数据路径

* 操作系统将数据从磁盘读入到内核空间的页缓存（page cache）
* 应用程序将数据从内核空间读取到用户空间缓存中（因为应用程序无法直接操纵内核空间，只能操作用户空间）
* 应用程序将数据写回到内核空间到socket缓存中（要发送到网络中，所以需要写到socket缓存中）
* 操作系统将数据从socket缓冲区复制到网卡缓冲区，以便将数据经网络发出

<!-- more -->

### 零拷贝过程

* 操作系统将数据从磁盘读入到内核空间的页缓存
* 将数据的位置和长度的信息的描述符增加至内核空间（socket缓冲区）
* 操作系统将数据从内核拷贝到网卡缓冲区，以便将数据经网络发出
> 直接简化到了直接从内核拷贝到了网卡缓冲区
> 零拷贝并不是指所有的拷贝次数为0，而是值内核空间和用户空间的交互拷贝为0，